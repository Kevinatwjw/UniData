## LiDAR Data Preprocessing Tools (LiDAR Tools)

This module contains tools for data format conversion and index generation required by the LiDAR generation model. It is designed to adapt the original or interpolated nuScenes dataset to be compatible with Occ2LiDAR's input requirements.

Script Directory: `lidar_tools/`

### 1. Script Functions

#### 1.1 `generate_12hz_indices.py`: Generate Dataset Split Indices

*   **Function**: Scans the 12Hz (or original) nuScenes dataset to generate sample index lists (`.json`) for training and validation sets. This is the first step for model training/inference to split the dataset.
*   **Input**: A folder containing metadata files like `scene.json`, `sample.json`.
*   **Output**: `nuScenes_nksr_occ_train_mini.json`, `nuScenes_nksr_occ_val_mini.json`, etc., under `data/split/`.

**Usage Example:**

```bash
# Generate indices for v1.0-mini version
python lidar_tools/generate_12hz_indices.py \
    --meta_dir data/nuscenes/v1.0-mini_12Hz \
    --version v1.0-mini
```

#### 1.2 `convert_12Hznuscenes_info_occ2lidar.py`: Convert 12Hz Interpolated Data

*   **Function**: Converts the 12Hz interpolated `.pkl` info file into the list format required by the Occ2LiDAR dataset class.
*   **Scenario**: When 12Hz interpolated data has been generated via UniData/ASAP.
*   **Input**: `nuscenes_mini_interp_12Hz_infos_{split}.pkl` generated by UniData.
*   **Output**: `*_converted.pkl` under `data/infos/`.

**Usage Example:**

```bash
# Convert validation set
python lidar_tools/convert_12Hznuscenes_info_occ2lidar.py \
    --version v1.0-mini \
    --split val

# Convert training set
python lidar_tools/convert_12Hznuscenes_info_occ2lidar.py \
    --version v1.0-mini \
    --split train
```

#### 1.3 `convert_2Hznuscenes_info_occ2lidar.py`: Convert 2Hz Original Data

*   **Function**: Converts the official nuScenes 2Hz `.pkl` info file into the list format required by the Occ2LiDAR dataset class. It also automatically fills in missing metadata (e.g., `is_key_frame`, `description`).
*   **Scenario**: Using original nuScenes data for baseline comparison experiments.
*   **Input**: Official `nuscenes_mini_infos_temporal_{split}_scene.pkl`.
*   **Output**: `*_converted.pkl` under `data/infos/`.

**Usage Example:**

```bash
# Convert validation set (pkl path required)
python lidar_tools/convert_2Hznuscenes_info_occ2lidar.py \
    --version v1.0-mini \
    --split val \
    --pkl_path data/nuscenes_mini_infos_temporal_val_scene.pkl
```